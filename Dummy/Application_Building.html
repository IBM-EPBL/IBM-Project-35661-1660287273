<!DOCTYPE HTML PUBLIC "-
//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/str
ict.dtd">
<html>
<head>
<meta http-equiv="Content-Type"
content="text/html; charset=UTF-8">
<title>Artificial intelligence : OpenKore source
code documentation</title>
<link rel="stylesheet" type="text/css"
href="openkore.css">
<!-- Fix broken PNG transparency for IE/Win5-6+ --
>
<!--[if gte IE 5.5000]>
<script type="text/javascript"
src="pngfix.js"></script>
<![endif]-->
<style type="text/css">
<!--
.example {
margin: 0.3cm;
margin-left: 0.5cm;

.comment {
font-style: italic;
}
.term {
border-bottom: 1px dotted black;
}
.cstr {
color: #007700;
}
-->
</style>
</head>
<body>
<div id="title">OpenKore source code documentation</div>
<div id="navigation">
<ul>
<li><a
href="http://openkore.sourceforge.net/">Main
website</a></li>
<li><a href="index.html">Table of
contents</a></li>
<li><b>Artificial intelligence</b></li>
</ul>
</div>
<div id="main">
<h1>How the AI subsystem is designed</h1>
The AI subsystem isn't really complex, but it could take
a while to understand it's design.
<p>
All "intelligence" is handled inside the
<code>AI()</code> function (right now it's one big
function but
we hope to split it in the future).
As explained in the <a>Main loop &amp; initialization</a>
page, the <code>AI()</code> function only runs less than
a fraction of a second.
<p>
Basically, the AI tells Kore to do certain things based
on the current situation. I'll try to explain it with
some examples.
<a name="ex1"></a>
<h2>Example 1: Random walk</h2>
You're probably familiar with Kore's random walk feature.
If there are no monsters and Kore isn't doing anything,
it will walk to a random spot on the map, and attack any
monsters it encounters.
The following piece of code (within the <code>AI()</code>
function makes Kore walk to a random spot if it isn't
doing anything:
<pre class="example">
1 <span class="comment">##### RANDOM WALK #####</span>
2 <b>if</b> ($config{'route_randomWalk'} && $ai_seq[0]
<b>eq</b> "" && @{$field{'field'}} > 1 &&
!$cities_lut{$field{'name'}.'.rsw'}) {
3 <span class="comment"># Find a random block on the
map that we can walk on</span>
4 <b>do</b> {
5 $ai_v{'temp'}{'randX'} = int(rand() *
($field{'width'} - 1));
6 $ai_v{'temp'}{'randY'} = int(rand() *
($field{'height'} - 1));
7 } <b>while</b>
($field{'field'}[$ai_v{'temp'}{'randY'}*$field{'width'} +
$ai_v{'temp'}{'randX'}]);
8
9 <span class="comment"># Move to that block</span>
10 message <span class="cstr">"Calculating random
route to:
$maps_lut{$field{'name'}.'.rsw'}($field{'name'}):
$ai_v{'temp'}{'randX'}, $ai_v{'temp'}{'randY'}\n"</span>,
<span class="cstr">"route"</span>;
11 ai_route(\%{$ai_v{'temp'}{'returnHash'}},
12 $ai_v{'temp'}{'randX'},
13 $ai_v{'temp'}{'randY'},
14 $field{'name'},
15 0,
16 $config{'route_randomWalk_maxRouteTime'},
17 2,
18 undef,
19 undef,
20 1);
21 }
</pre